<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:searchable="False">
    <head><title><MadCap:variable name="Heading.Level1" /></title>
        <link rel="canonical" href="https://docs.liquibase.com/start/release-notes/liquibase-release-notes/liquibase-4.21.0.html" />
        <meta name="description" content="Liquibase 4.21.0 release notes." />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <h1><MadCap:variable name="General.CompanyName" /> 4.21.0 Release Notes</h1>
        <p><b>Full Changelog:</b>&#160;<a href="https://github.com/liquibase/liquibase/compare/v4.20.0...v4.21.0">v4.20.0...v4.21.0</a> (April 13, 2023)</p>
        <p>Liquibase v4.21.0 is a major release</p>
        <h3>Notable Changes</h3>
        <h4>[PRO] Observability Initiative - Structured Logging</h4>
        <p>Structured Logging makes <MadCap:variable name="General.CompanyName" /> operation data easily available for automated monitoring and analysis tools to read, query, and act upon in automated workflows. This feature significantly improves the way <MadCap:variable name="General.CompanyName" /> logs its actions and events to make records machine-readable, easily-ingested, and queryable by industry-standard observability and analysis tools. Learn more at <MadCap:xref href="../../../tools-integrations/observability/structured-logging.htm">[%=General.StructuredLogging%]</MadCap:xref>.</p>
        <h3>Command refactoring</h3>
        <ul>
            <li>Refactor <code>update-to-tag</code> command step (DAT-6641) by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/3916" title="#3916" alt="#3916">#3916</a></li>
            <li>Refactor <code>update-to-tag-SQL</code> command step (DAT-6642) by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/3917" title="#3917" alt="#3917">#3917</a></li>
            <li>Refactor <code>Rollback</code> and <code>RollbackSQL</code> command by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3991" title="#3991" alt="#3991">#3991</a></li>
            <li>Refactor <code>ListLocksCommand</code> by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3952" title="#3952" alt="#3952">#3952</a></li>
            <li>Refactor <code>ReleaseLocksCommand</code> by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3953" title="#3953" alt="#3953">#3953</a></li>
            <li>Refactoring of <code>rollbackCount[SQL]</code> commands by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4077" title="#4077" alt="#4077">#4077</a></li>
            <li>Refactor <code>update</code>, <code>updateSql</code>, <code>updateCount</code>, <code>updateCountSql</code> to use Command framework (DAT-6600/DAT-6601) by @abrackx in <a href="https://github.com/liquibase/liquibase/pull/3866" title="#3866" alt="#3866">#3866</a></li>
            <li>Refactor <code>update</code> to use command framework DAT-6600 by @abrackx in <a href="https://github.com/liquibase/liquibase-pro/pull/849" title="#849" alt="#849">#849</a></li>
        </ul>
        <h3>Enhancements</h3>
        <ul>
            <li><b>[PRO]</b> New <code>runWithSpoolFile</code> attribute for <code>runWith</code>&#160;<MadCap:variable name="General.changeset" />s DAT-12881 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/3864" title="#3864" alt="#3864">#3864</a></li>
            <li>New update summary output table for update commands DAT-13182 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/3812" title="#3812" alt="#3812">#3812</a></li>
        </ul>
        <h3>Security, Driver and other updates</h3>
        <ul>
            <li><b>[PRO]</b> Bump <code>logback-classic</code> from 1.4.5 to 1.4.6 by @dependabot in <a href="https://github.com/liquibase/liquibase-pro/pull/884" title="#884" alt="#884">#884</a></li>
            <li><b>[PRO]</b> Bump <code>flatten-maven-plugin</code> from 1.3.0 to 1.4.0 by @dependabot in <a href="https://github.com/liquibase/liquibase-pro/pull/893" title="#893" alt="#893">#893</a></li>
            <li><b>[PRO]</b> Bump <code>postgresql</code> from 42.5.4 to 42.6.0 by @dependabot in <a href="https://github.com/liquibase/liquibase-pro/pull/892" title="#892" alt="#892">#892</a></li>
            <li><b>[PRO]</b> Bump <code>jacoco-maven-plugin</code> from 0.8.8 to 0.8.9 by @dependabot in <a href="https://github.com/liquibase/liquibase-pro/pull/925" title="#925" alt="#925">#925</a></li>
            <li><b>[PRO]</b> Snakeyaml 2.0 by @filipelautert in <a href="https://github.com/liquibase/liquibase-pro/pull/858" title="#858" alt="#858">#858</a></li>
            <li>Bump <code>targetMavenVersion</code> from 3.8.7 to 3.9.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3785" title="#3785" alt="#3785">#3785</a></li>
            <li>Bump <code>actions/cache</code> from 3.2.6 to 3.3.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3936" title="#3936" alt="#3936">#3936</a></li>
            <li>Bump <code>maven-plugin-plugin</code> from 3.7.1 to 3.8.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3871" title="#3871" alt="#3871">#3871</a></li>
            <li>Bump <code>maven-compiler-plugin</code> from 3.10.1 to 3.11.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3870" title="#3870" alt="#3870">#3870</a></li>
            <li>Bump <code>snowflake-jdbc</code> from 3.13.27 to 3.13.28 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3863" title="#3863" alt="#3863">#3863</a></li>
            <li>Bump <code>sqlite-jdbc</code> from 3.40.1.0 to 3.41.0.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3862" title="#3862" alt="#3862">#3862</a></li>
            <li>Bump <code>maven-assembly-plugin</code> from 3.4.2 to 3.5.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3" title="#3" alt="#3">#3</a></li>
            <li>Bump <code>snowflake-jdbc</code> from 3.13.28 to 3.13.29 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3981" title="#3981" alt="#3981">#3981</a></li>
            <li>Bump <code>postgresql</code> from 42.5.4 to 42.6.0 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3982" title="#3982" alt="#3982">#3982</a></li>
            <li>Bump <code>maven-resources-plugin</code> from 3.3.0 to 3.3.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/4025" title="#4025" alt="#4025">#4025</a></li>
            <li>Bump <code>mariadb-java-client</code> from 3.1.2 to 3.1.3 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/4006" title="#4006" alt="#4006">#4006</a></li>
            <li>Bump <code>slf4j-jdk14</code> from 2.0.6 to 2.0.7 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3979" title="#3979" alt="#3979">#3979</a></li>
            <li>Bump <code>targetMavenVersion</code> from 3.9.0 to 3.9.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3980" title="#3980" alt="#3980">#3980</a></li>
            <li>Bump <code>actions/cache</code> from 3.3.0 to 3.3.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/3948" title="#3948" alt="#3948">#3948</a></li>
            <li>Bump <code>maven-deploy-plugin</code> from 3.1.0 to 3.1.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/4026" title="#4026" alt="#4026">#4026</a></li>
            <li>Bump <code>maven-install-plugin</code> from 3.1.0 to 3.1.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/4027" title="#4027" alt="#4027">#4027</a></li>
            <li>Bump <code>sqlite-jdbc</code> from 3.41.0.0 to 3.41.2.1 by @dependabot in <a href="https://github.com/liquibase/liquibase/pull/4028" title="#4028" alt="#4028">#4028</a></li>
            <li>Upgrade <code>maven-javadoc-plugin</code> version to 3.5.0 by @MalloD12 in <a href="https://github.com/liquibase/liquibase/pull/3973" title="#3972" alt="#3972">#3972</a></li>
            <li>Release <code>liquibase-cdi-jakarta</code> to maven repositories by @DCCSKrezovic in <a href="https://github.com/liquibase/liquibase/pull/4001" title="#4001" alt="#4001">#4001</a></li>
            <li>Upgrade spring 5 version by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4015" title="#4015" alt="#4015">#4015</a></li>
            <li>Snakeyaml 2.0 by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3893" title="#3893" alt="#3893">#3893</a></li>
            <li>Upgrade AdoptOpenJDK bundled in the JVM installer to version 17.0.6+10 by @MalloD12 in <a href="https://github.com/liquibase/liquibase/pull/3900" title="#3900" alt="#3900">#3900</a></li>
        </ul>
        <h3>Fixes</h3>
        <ul>
            <li><b>[PRO]</b> DAT-12881 Implement <code>runWithSpoolFile</code> attribute and <code>createSpool</code> property to control use of Oracle spooling by @wwillard7800 in <a href="https://github.com/liquibase/liquibase-pro/pull/843" title="#843" alt="#843">#843</a></li>
            <li><b>[PRO]</b> DAT-12814: '<code>--rollback-on-error</code>' should return <code>ERROR</code> and return code 1 when update fails by @StevenMassaro in <a href="https://github.com/liquibase/liquibase-pro/pull/905" title="#905" alt="#905">#905</a></li>
            <li><b>[PRO]</b> DAT-13968 Added missing overwrite property by @wwillard7800 in <a href="https://github.com/liquibase/liquibase-pro/pull/895" title="#895" alt="#895">#895</a></li>
            <li><b>[PRO]</b> DAT-13667 Make sure exception from SQLCMD is propagated back to be displayed by @wwillard7800 in <a href="https://github.com/liquibase/liquibase-pro/pull/902" title="#902" alt="#902">#902</a></li>
            <li><b>[PRO]</b> DAT-14096 Handle existence of a file extension when creating spool/sql/log files by @wwillard7800 in <a href="https://github.com/liquibase/liquibase-pro/pull/913" title="#913" alt="#913">#913</a></li>
            <li><b>[PRO]</b> DAT-13994: strip leading slashes from contexts by @StevenMassaro in <a href="https://github.com/liquibase/liquibase-pro/pull/921" title="#921" alt="#921">#921</a></li>
            <li><code>ChangelogSync</code> family to CommandStep refactoring by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3859" title="#3859" alt="#3859">#3859</a></li>
            <li>Improved concurrency support in ReflectionSerializer by @Dasiu in <a href="https://github.com/liquibase/liquibase/pull/3840" title="#3840" alt="#3840">#3840</a></li>
            <li>Make Pattern instance variables and avoid recalculating each time by @arturobernalg in <a href="https://github.com/liquibase/liquibase/pull/3656" title="#3656" alt="#3656">#3656</a></li>
            <li>Java 8 improvements by @arturobernalg in <a href="https://github.com/liquibase/liquibase/pull/3712" title="#3712" alt="#3712">#3712</a></li>
            <li>Map 'double' to SQL type 'DOUBLE PRECISION' for an Oracle database (CORE-3165) by @maartenc in <a href="https://github.com/liquibase/liquibase/pull/3707" title="#3707" alt="#3707">#3707</a></li>
            <li>Rollback Snakeyaml default config to allow duplicate keys by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3939" title="#3939" alt="#3939">#3939</a></li>
            <li>Upgrades snakeyaml for installer by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3943" title="#3943" alt="#3943">#3943</a></li>
            <li>DAT-12842 by @sayaliM0412 in <a href="https://github.com/liquibase/liquibase/pull/3909" title="#3909" alt="#3909">#3909</a></li>
            <li>Improve use of generics in code by @arturobernalg in <a href="https://github.com/liquibase/liquibase/pull/3797" title="#3797" alt="#3797">#3797</a></li>
            <li>DAT-12842 by @sayaliM0412 in <a href="https://github.com/liquibase/liquibase/pull/3963" title="#3963" alt="#3963">#3963</a></li>
            <li>Performance Improvement: optimized <code>DatabaseChangeLog.normalizePath()</code> by @nvoxland in <a href="https://github.com/liquibase/liquibase/pull/3853" title="#3853" alt="#3853">#3853</a></li>
            <li>Clear entries from MDC map on scope exit by @amrasarfeiniel in <a href="https://github.com/liquibase/liquibase/pull/3927" title="#3927" alt="#3927">#3927</a></li>
            <li>[3910] fix missing OSGI manifest entries for service loaders by @jherkel in <a href="https://github.com/liquibase/liquibase/pull/3912" title="#3912" alt="#3912">#3912</a></li>
            <li>Fixes #3734 MySQL ENUM and SET column type by @nwcm in <a href="https://github.com/liquibase/liquibase/pull/3842" title="#3842" alt="#3842">#3842</a></li>
            <li>Change <code>Index.setTable</code> method to take a Relation parameter DAT-13676 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/3987" title="#3987" alt="#3987">#3987</a></li>
            <li>only set the execType to <code>RERAN</code>, if the <MadCap:variable name="General.changeset" /> was actually executed by @AlexGruebel in <a href="https://github.com/liquibase/liquibase/pull/3926" title="#3926" alt="#3926">#3926</a></li>
            <li>Create the change exec listener earlier so that it is available if there is an exception DAT-13939 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/3954" title="#3954" alt="#3954">#3954</a></li>
            <li>[3906]  Don't break <MadCap:variable name="General.Liquibase" /> if a resolveable hostname is not found by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3960" title="#3960" alt="#3960">#3960</a></li>
            <li>Rename <code>ON_MISSING_INCLUDE_FILE</code> configuration and property names by @MalloD12 in <a href="https://github.com/liquibase/liquibase/pull/3899" title="#3899" alt="#3899">#3899</a></li>
            <li>Load XSD files under OSGI by @ponziani in <a href="https://github.com/liquibase/liquibase/pull/3378" title="#3378" alt="#3378">#3378</a></li>
            <li>Fixes #3083 MySQL JSON length issue by @nwcm in <a href="https://github.com/liquibase/liquibase/pull/3849" title="#3849" alt="#3849">#3849</a></li>
            <li>Prevention of NullpointerException (unboxing) in <code>generate-changelog</code> with MS SQL Server by @barthel in <a href="https://github.com/liquibase/liquibase/pull/3903" title="#3903" alt="#3903">#3903</a></li>
            <li>Issue 3619 - Allow control of recursion for <code>includeAll</code> via <code>minDepth</code> and <code>maxDepth</code> attributes by @jasonlyle88 in <a href="https://github.com/liquibase/liquibase/pull/3620" title="#3620" alt="#3620">#3620</a></li>
            <li>Avoid String concatenation in loop. by @arturobernalg in <a href="https://github.com/liquibase/liquibase/pull/3668" title="#3668" alt="#3668">#3668</a></li>
            <li>fix <code>NullPointerException</code> in <code>ResourceAccessor</code> by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/4040" title="#4040" alt="#4040">#4040</a></li>
            <li>Lowers message log level. by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4046" title="#4046" alt="#4046">#4046</a></li>
            <li>Remove potentially sensitive information from <code>--monitor-performance</code> by @nvoxland in <a href="https://github.com/liquibase/liquibase/pull/3640" title="#3640" alt="#3640">#3640</a></li>
            <li>Add <code>mirror-console-messages-to-log</code> parameter (DAT-13802) by @abrackx in <a href="https://github.com/liquibase/liquibase/pull/4032" title="#4032" alt="#4032">#4032</a></li>
            <li>Do not ignore <code>DatabaseException</code> for Snowflake by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4034" title="#4034" alt="#4034">#4034</a></li>
            <li>Fix <code>DB-Doc</code> generation of Unique Constraints for Sybase ASE database. by @crenan in <a href="https://github.com/liquibase/liquibase/pull/3911" title="#3911" alt="#3911">#3911</a></li>
            <li>Lowers Snakeyaml log level for warning stack traces by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4062" title="#4062" alt="#4062">#4062</a></li>
            <li>Remove unused parameters and local variables by @arturobernalg in <a href="https://github.com/liquibase/liquibase/pull/3857" title="#3857" alt="#3857">#3857</a></li>
            <li>Do not show update summary for <code>updateCountSql</code> or <code>updateTagSql</code> DAT-14107 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/4060" title="#4060" alt="#4060">#4060</a></li>
            <li>add additional information to <code>toString</code>/<code>describe</code> methods of SQLFileChange (DAT-13789) by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/4059" title="#4059" alt="#4059">#4059</a></li>
            <li>Update <code>ShowSummar</code>y argument reference from <code>CommandUtil</code> class to fix failing integration tests by @MalloD12 in <a href="https://github.com/liquibase/liquibase/pull/4073" title="#4073" alt="#4073">#4073</a></li>
            <li>strip leading slashes from contexts (DAT-13994) by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/4071" title="#4071" alt="#4071">#4071</a></li>
            <li>Appends the table type to the statement using it. by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4000" title="#4000" alt="#4000">#4000</a></li>
            <li>Update runner image for pr builds (DAT-14192) by @abrackx in <a href="https://github.com/liquibase/liquibase/pull/4094" title="#4094" alt="#4094">#4094</a></li>
            <li>Do not allow custom change types to execute twice DAT-14051 by @wwillard7800 in <a href="https://github.com/liquibase/liquibase/pull/4054" title="#4054" alt="#4054">#4054</a></li>
            <li>Disables buffered log service if not using hub by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/3969" title="#3969" alt="#3969">#3969</a></li>
            <li>Fixes <code>UnsupportedOperationException</code> thrown in <code>SpringResourceAccessor</code> in Spring Boot 3 Native Image by @justin-tay in <a href="https://github.com/liquibase/liquibase/pull/3959" title="#3959" alt="#3959">#3959</a></li>
            <li>Do not repeat MDC logging by @filipelautert in <a href="https://github.com/liquibase/liquibase/pull/4088" title="#4088" alt="#4088">#4088</a></li>
            <li>Implement <code>Strict</code> global configuration support to control whether non-empty <code>author</code> attribute is allowed or not by @MalloD12 in <a href="https://github.com/liquibase/liquibase/pull/4044" title="#4044" alt="#4044">#4044</a></li>
            <li>Read Snowflake views definitions with the Snowflake-specific query by @LonwoLonwo in <a href="https://github.com/liquibase/liquibase/pull/3794" title="#3794" alt="#3794">#3794</a></li>
            <li>Fixed #3745 error generation intType when using <code>autoIncrement=true</code> with H2 V2 by @quonas in <a href="https://github.com/liquibase/liquibase/pull/4008" title="#4008" alt="#4008">#4008</a></li>
            <li>log generated <code>databasechangelogsql</code> without erroneously incrementing the order executed by 2 (DAT-13680) by @StevenMassaro in <a href="https://github.com/liquibase/liquibase/pull/4097" title="#4097" alt="#4097">#4097</a></li>
            <li>Remove native executor name property (DAT-13580) by @abrackx in <a href="https://github.com/liquibase/liquibase/pull/4108" title="#4108" alt="#4108">#4108</a></li>
        </ul>
        <h3>New Contributors</h3>
        <ul>
            <li>@maartenc made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3707" title="#3707" alt="#3707">#3707</a></li>
            <li>@amrasarfeiniel made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3927" title="#3927" alt="#3927">#3927</a></li>
            <li>@nwcm made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3842" title="#3842" alt="#3842">#3842</a></li>
            <li>@AlexGruebel made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3926" title="#3926" alt="#3926">#3926</a></li>
            <li>@ponziani made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3378" title="#3378" alt="#3378">#3378</a></li>
            <li>@barthel made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3903" title="#3903" alt="#3903">#3903</a></li>
            <li>@DCCSKrezovic made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/4001" title="#4001" alt="#4001">#4001</a></li>
            <li>@justin-tay made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/3959" title="#3959" alt="#3959">#3959</a></li>
            <li>@quonas made their first contribution in <a href="https://github.com/liquibase/liquibase/pull/4008" title="#4008" alt="#4008">#4008</a></li>
        </ul>
    </body>
</html>