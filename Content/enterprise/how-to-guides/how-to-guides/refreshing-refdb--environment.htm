<?xml version="1.0" encoding="utf-8"?>
<html>
    <head><title></title>
    </head>
    <body>
        <h1>How To: Refreshing RefDb from another environment</h1> <MadCap:snippetText src="../../../Resources/Snippets/images/.ver_icon_size_enterprise.flsnp" /><p>When refreshing the RefDb from another environment (such as PROD or UAT) please ensure the following:</p><ol><li><p>The <strong>data</strong> in <strong>DATABASECHANGELOG</strong> and <strong>DATABASECHANGELOGLOCK </strong>tables must be copied from the source database to the target RefDb.</p><ol><li><p>For multi-schema projects, the schema for these tables can be found by checking the <strong>datical.project</strong> file for the <strong>trackingSchema</strong> attribute on row 2.</p><ol><li><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" loading="lazy" src="https://datical-cs.atlassian.net/wiki/download/attachments/1844183041/image-20201110-223157.png?version=1&amp;modificationDate=1605047520422&amp;cacheVersion=1&amp;api=v2" /></span></li></ol></li><li><p>For single schema projects the tables will be present in the managed schema.</p></li></ol></li><li><p><strong>Grants:</strong> Ensure any necessary grants are added to the RefDb.</p></li><li><p><strong>ORACLE:</strong> In the event of <strong>server outage</strong> or <strong>unexpected shutdown</strong> which requires a refresh of the RefDb, check that no orphan datapump jobs remain on the server.</p><ol><li><p><a class="external-link" href="https://urldefense.proofpoint.com/v2/url?u=https-3A__www.oracle-2Dscripts.net_cleanup-2Dorphaned-2Ddatapump-2Djobs_&amp;d=DwMFAg&amp;c=SFszdw3oxIkTvaP4xmzq_apLU3uL-3SxdAPNkldf__Q&amp;r=vjSXaJdLZHG-r90_mGGFYsP636q6NysLE5xywMgj4oM&amp;m=DIBkbDMpqtIvGD1gnurb400PjUdE9Pu3LFt-FsnNgSY&amp;s=WWp7x53wQJ95hixJm5ypys8kUn20VizQUBxuCfXdSGY&amp;e=" rel="nofollow">https://www.oracle-scripts.net/cleanup-orphaned-datapump-jobs</a></p></li><li><p>Orphan jobs may result in the following error during the restore operation of a Packager job:</p><ol><li><p /><div class="code panel pdl conf-macro output-block" style="border-width: 1px;"><div class="codeContent panelContent pdl"><pre class="syntaxhighlighter-pre" xml:space="preserve">ORA-06512: at "SYS.DBMS_DATAPUMP", line 7143
ORA-06512: at "SYS.DBMS_SYS_ERROR", line 79
ORA-06512: at "SYS.DBMS_DATAPUMP", line 4932
ORA-06512: at "SYS.DBMS_DATAPUMP", line 7137</pre></div></div></li></ol></li></ol></li></ol><div class="confluence-information-macro confluence-information-macro-information conf-macro output-block"><div class="confluence-information-macro-body"><p>Failure to copy the <strong>DATABASECHANGELOG</strong> table data will result in re-deployment of all changesets in the changelog.xml file to the RefDb. This will cause errors for non-rerunnable scripts. Users may find that scripts that were added months ago are suddenly trying to Package again which will lead to confusion.</p></div></div><p /></body>
</html>