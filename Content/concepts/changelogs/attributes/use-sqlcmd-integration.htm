<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title><MadCap:variable name="Heading.Level1" /></title>
        <meta rel="canonical" href="https://docs.liquibase.com/concepts/changelogs/attributes/use-sqlcmd-integration.html" />
        <meta name="description" content="The page describes how to use the SQLCMD integration and runWith attribute with Liquibase Pro and MSSQL Server" />
    </head>
    <body>
        <h1>Use SQLCMD and <code>runWith</code> on MSSQL Server</h1>
        <MadCap:snippetText src="../../../Z_Resources/Snippets/images/icon-pro-top.flsnp" />
        <p>This page describes how to use <MadCap:variable name="General.Liquibase" /> with the SQLCMD native executor on an MSSQL database.</p>
        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/text/parameter-runwith-prereqs-setup.flsnp" MadCap:conditionTagExpression="include[parameter-run-with-executors.sqlcmd]" />
        <h2>Use the SQLCMD integration with multiple databases</h2>
        <p>To use <MadCap:variable name="General.Liquibase" /> and <code>sqlcmd</code> utility on an instance with multiple databases:</p>
        <ol>
            <li>Create the <code>liquibase.sqlcmd.conf</code> file for each database you use and ensure it is in the directory from which <MadCap:variable name="General.Liquibase" /> runs the files
            </li>
            <li>In each <code>liquibase.sqlcmd.conf</code> file, add a line like the following one: 
<pre xml:space="preserve"><code class="language-text">liquibase.sqlcmd.args=-v MYDATABASE=db_dev</code></pre></li>
            <li>Add <code>USE $(MYDATABASE)</code> to each <MadCap:variable name="General.changeset" /> that uses the <code>runWith</code> <MadCap:variable name="General.Param/Attribute" /></li>
            <p>Example:</p><pre xml:space="preserve"><code class="language-text">USE $(MYDATABASE)
CREATE TABLE [dbo].[course] (
[CourseId] INT IDENTITY (1, 1) NOT NULL,
[Name] VARCHAR (30) NOT NULL,
[Detail] VARCHAR (200) NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED ([CourseId] ASC) 8);</code></pre>
        </ol>
        <p>The <code>update</code> command will replace the correct value at runtime.</p>
        <h2><a name="SQL"></a>SQLCMD integration arguments</h2>
        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/note/parameter-syntax.flsnp" />
        <table>
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <th>Syntax (<code>--cli</code>, <code>propertiesFile</code>, <code>ENV_VAR</code>)</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-args
liquibase.sqlcmd.args
LIQUIBASE_SQLCMD_ARGS</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-args.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-catalog-name
liquibase.sqlcmd.catalogName
LIQUIBASE_SQLCMD_CATALOG_NAME</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-catalog-name.flsnp" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-keep-temp
liquibase.sqlcmd.keep.temp
LIQUIBASE_SQLCMD_KEEP_TEMP</code></pre>
                    </td>
                    <td>Boolean</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-keep-temp.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-keep-temp-name
liquibase.sqlcmd.keep.temp.name
LIQUIBASE_SQLCMD_KEEP_TEMP_NAME</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-keep-temp-name.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-keep-temp-overwrite
liquibase.sqlcmd.keep.temp.overwrite
LIQUIBASE_SQLCMD_KEEP_TEMP_OVERWRITE</code></pre>
                    </td>
                    <td>Boolean</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-keep-temp-overwrite.flsnp" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-keep-temp-path
liquibase.sqlcmd.keep.temp.path
LIQUIBASE_SQLCMD_KEEP_TEMP_PATH</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-keep-temp-path.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-log-file
liquibase.sqlcmd.logFile
LIQUIBASE_SQLCMD_LOG_FILE</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-log-file.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-path
liquibase.sqlcmd.path
LIQUIBASE_SQLCMD_PATH</code></pre>
                    </td>
                    <td>String</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-path.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
                <tr>
                    <td><pre xml:space="preserve"><code class="language-text">--sqlcmd-timeout
liquibase.sqlcmd.timeout
LIQUIBASE_SQLCMD_TIMEOUT</code></pre>
                    </td>
                    <td>Integer</td>
                    <td>
                        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/def/attributes/cli/executors/cli-global-timeout.flsnp" MadCap:conditionTagExpression="include[command-executors.sqlcmd]" />
                    </td>
                </tr>
            </tbody>
        </table>
        <MadCap:dropDown>
            <MadCap:dropDownHead>
                <MadCap:dropDownHotspot><a name="runWith"></a><code style="font-size: 18pt;">runWith</code><span style="font-size: 18pt;"> and </span><code style="font-size: 18pt;">sqlcmd</code><span style="font-size: 18pt;"> examples</span>
                </MadCap:dropDownHotspot>
            </MadCap:dropDownHead>
            <MadCap:dropDownBody>
                <h3>Formatted SQL <MadCap:variable name="General.changeset" style="font-style: normal; font-weight: bold;" /> using the <code>runWith</code> <MadCap:variable name="General.Param/Attribute" style="font-weight: bold;" /></h3><pre xml:space="preserve"><code class="language-html">-- liquibase formatted sql
				
-- changeset myauthorname:2314 runWith:sqlcmd
			
	DECLARE l_emp_name VARCHAR2(250);	
	l_emp_no NUMBER;	
	l_salary NUMBER;	
			
	l_manager VARCHAR2(250);	
	BEGIN	
	INSERT INTO emp(emp_name,emp_no,salary,manager) VALUES('BBB',1000,25000,'AAA');
	
	...	
	END;		
	/</code></pre>
                <h3>XML <MadCap:variable name="General.changelog" /> with the inline SQL <MadCap:variable name="General.changeset" style="font-style: normal;" /> using the <code>runWith</code> <MadCap:variable name="General.Param/Attribute" /></h3><pre xml:space="preserve"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
<MadCap:snippetText src="../../../Z_Resources/Snippets/code/liquibase-xsd-xml-changelog-closed.flsnp" />

&lt;changeSet id="2" author="myauthorname" runWith="sqlcmd"&gt; 
&lt;sql&gt;
	DECLARE l_emp_name VARCHAR2(250);
	l_emp_no NUMBER;
	l_salary NUMBER;
	l_manager VARCHAR2(250);
       BEGIN
	INSERT INTO emp(emp_name,emp_no,salary,manager) VALUES('BBB',1000,25000,'AAA');
	...
	END;
	/
&lt;/sql&gt; 

&lt;/changeSet&gt;</code></pre>
                <h3>XML <MadCap:variable name="General.changelog" style="font-style: normal;" /> pointing to an SQL file with raw SQL in it</h3><pre xml:space="preserve"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
<MadCap:snippetText src="../../../Z_Resources/Snippets/code/liquibase-xsd-xml-changelog-closed.flsnp" />

&lt;changeSet id="2315" author="myauthorname" runWith="sqlcmd"&gt;  
	&lt;sqlFile
	path="my/path/file.sql"
... &gt; 
&lt;/changeSet&gt;</code></pre>
                <h3>YAML <MadCap:variable name="General.changelog" style="font-style: normal;" /> pointing to an SQL file with raw SQL in it
                </h3><pre xml:space="preserve"><code class="language-yaml" data-lang="yaml">databaseChangeLog:
   - changeSet:
       id: 1-yaml
       author: myauthorname
       runWith: sqlcmd
       changes:
       - sqlFile:
           path: person.sql
           relativeToChangelogFile: true</code></pre>
                <h3>JSON <MadCap:variable name="General.changelog" style="font-style: normal;" /> pointing to an SQL file with raw SQL in it
                </h3><pre xml:space="preserve"><code class="language-json" data-lang="json">{
	"databaseChangeLog": [
	   {
		"changeSet": {
		  "id": "1-json",
		  "author": "myauthorname",
		  "runWith": "sqlcmd",
		  "changes": [
			{
			      "sqlFile":{
				      "path": "person.sql",
				      "relativeToChangelogFile": "true"
				}
			 }
		   ]
	     }
       }</code></pre>
            </MadCap:dropDownBody>
        </MadCap:dropDown>
        <MadCap:snippetBlock src="../../../Z_Resources/Snippets/text/parameter-runwith-best-practices.flsnp" MadCap:conditionTagExpression="include[parameter-run-with-executors.sqlcmd]">
        </MadCap:snippetBlock>
        <h2>Related links</h2>
        <ul>
            <li>
                <MadCap:xref href="runwith.htm">runWith</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../../../change-types/modifychangesets.htm">modifyChangeSets</MadCap:xref>
            </li>
            <li>
                <MadCap:xref href="../../../start/tutorials/ms-sql-server.html">Using [%=General.Liquibase%] with MSSQL</MadCap:xref>
            </li>
        </ul>
    </body>
</html>